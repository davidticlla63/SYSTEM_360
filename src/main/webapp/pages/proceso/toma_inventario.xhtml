<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
	template="/WEB-INF/templates/template_main.xhtml">
	<ui:define name="head">
		<title>Ajuste de Inventario</title>

		<f:event listener="#{tomaInventarioController.initConversation}"
			type="preRenderView"></f:event>

	</ui:define>

	<ui:define name="content">
		<!--BEGIN CONTENT-->
		<div class="content">
			<section class="main-content"
				style="background-color: #f5f6f6; padding-top: 0px;">
				<h:form id="form001">

					<!-- BEGIN BUTTONS -->
					<div class="row" style="background-color: #f9fafa;">
						<section class="content-header">
							<div class="pull-left"
								style="padding-top: 8px; padding-left: 15px;">
								<div class="btn-group-demo">
									<div class="btn-group">

										<p:commandLink id="buttonAtras" value="&#160; Atras"
											styleClass="btn btn-warning ion-minus-circled"
											update="form001"
											rendered="#{tomaInventarioController.verButtonReport}"
											style="height:31px; padding:center"
											action="#{tomaInventarioController.loadDefault()}">
										</p:commandLink>

										<p:commandLink id="buttonCancelar" value="&#160; Cancelar"
											styleClass="btn btn-warning ion-minus-circled"
											update="form001"
											rendered="#{tomaInventarioController.modificar or tomaInventarioController.registrar or tomaInventarioController.conciliar or tomaInventarioController.revisarReport}"
											style="height:31px; padding:center" immediate="true"
											action="#{tomaInventarioController.loadDefault()}">
										</p:commandLink>

										<p:commandLink id="buttonCrear1"
											value="&#160; Ajuste de Inventario"
											styleClass="btn btn-success ion-plus-round"
											rendered="#{tomaInventarioController.crear and  tomaInventarioController.selectedTomaInventario == null }"
											update="form001"
											action="#{tomaInventarioController.cambiarAspecto()}"
											style="height:31px;">
										</p:commandLink>

										<p:commandLink id="buttonRegistrar" value="&#160; Registrar 1"
											styleClass="btn btn-success ion-checkmark"
											rendered="#{tomaInventarioController.verGuardar}"
											update="form001" style="height:31px; padding:center"
											action="#{tomaInventarioController.registrarTomaInventarioPrevio()}">
										</p:commandLink>

										<p:commandLink id="buttonProcesar" value="&#160; Procesar 0"
											styleClass="btn btn-info ion-ios7-loop-strong"
											style="height:31px; padding:center"
											rendered="#{tomaInventarioController.registrar and ! tomaInventarioController.newTomaInventario.tipo.equals('INICIAL') }"
											update="form001"
											action="#{tomaInventarioController.procesarConsulta()}">
										</p:commandLink>

										<p:commandLink id="buttonVerModificar" value="&#160; Revisar 1"
											styleClass="btn btn-info ion-edit"
											rendered="#{tomaInventarioController.buttonEditarTomaInventarioIncial}"
											style="height:31px; padding:center" update="form001"
											action="#{tomaInventarioController.cargarSelectedTomaInventario()}">
										</p:commandLink>

										<p:commandLink id="buttonProcesar2" value="&#160; Procesar 1"
											styleClass="btn btn-info ion-ios7-loop-strong"
											style="height:31px; padding:center"
											rendered="#{tomaInventarioController.buttonProcesarTomaInventarioIncial }"
											update="form001"
											action="#{tomaInventarioController.procesarTomaInventarioInicial()}">
										</p:commandLink>

										<p:commandLink id="buttonVerReporte"
											value="&#160; Ver Reporte"
											styleClass="btn btn-info ion-printer"
											rendered="#{tomaInventarioController.selectedTomaInventario != null and tomaInventarioController.verButtonReport }"
											style="height:31px; padding:center" update="form001"
											action="#{tomaInventarioController.cargarReporte()}">
										</p:commandLink>

										<p:commandLink id="buttonRegistrar2" value="&#160; Registrar 2"
											styleClass="btn btn-success ion-checkmark"
											rendered="#{ tomaInventarioController.revisarReport and (tomaInventarioController.listDetalleTomaInventario.size()>0)}"
											update="form001" style="height:31px; padding:center"
											action="#{tomaInventarioController.verificacionTomaInventario()}">
										</p:commandLink>

										<p:commandLink id="buttonRevisar" value="&#160; Revisar 2"
											styleClass="btn btn-info ion-edit"
											style="height:31px; padding:center"
											rendered="#{ tomaInventarioController.revisarReport }"
											update="form001"
											action="#{tomaInventarioController.buttonRevisar()}">
										</p:commandLink>

										<p:commandLink id="buttonConciliar1" value="&#160; Conciliar "
											styleClass="btn btn-info ion-ios7-loop-strong"
											style="height:31px; padding:center"
											rendered="#{tomaInventarioController.buttonConciliar }"
											update="form001"
											action="#{tomaInventarioController.buttonConciliarTomaInventario()}">
										</p:commandLink>

										<p:commandLink id="buttonConciliar2" value="&#160; Conciliar "
											styleClass="btn btn-info ion-ios7-loop-strong"
											style="height:31px; padding:center"
											rendered="#{tomaInventarioController.conciliar}"
											update="form001"
											action="#{tomaInventarioController.conciliarTomaInventario()}">
										</p:commandLink>

										<p:commandLink id="buttonRegistrar3" value="&#160; Registrar 3"
											styleClass="btn btn-success ion-checkmark"
											rendered="#{tomaInventarioController.newTomaInventario.tipo.equals('INICIAL') and tomaInventarioController.registrar and !tomaInventarioController.editarTomaInventarioIncial }"
											update="form001" style="height:31px; padding:center"
											action="#{tomaInventarioController.registrarTomaInventarioPrevio()}">
										</p:commandLink>

										<p:commandLink id="buttonRegistrar4" value="&#160; Registrar 4"
											styleClass="btn btn-success ion-checkmark"
											rendered="#{tomaInventarioController.editarTomaInventarioIncial}"
											update="form001" style="height:31px; padding:center"
											actionListener="#{tomaInventarioController.modificarTomaInventario()}">
										</p:commandLink>

										<p:commandLink id="buttonCierreAlmacen"
											value="&#160; Cierre Almacén"
											styleClass="btn btn-info ion-ios7-loop-strong"
											style="height:31px; padding:center"
											rendered="#{tomaInventarioController.cierreAlmacen}"
											update="form001"
											action="#{tomaInventarioController.cerrarAlmacenPorGestion()}">
										</p:commandLink>

										<p:commandLink id="buttonCargarGestionAnterior"
											value="&#160; Cargar Desde Gestión Anterior"
											styleClass="btn btn-info ion-ios7-loop-strong"
											style="height:31px; padding:center"
											rendered="#{tomaInventarioController.hayGestionAnterior}"
											update="form001"
											action="#{tomaInventarioController.cargarDatosDeGestionAnterior()}">
										</p:commandLink>
									</div>

								</div>
							</div>
							<div class="pull-right">
								<ol class="breadcrumb">
									<li><a href="#{request.contextPath}/pages/dashboard.xhtml"
										style="color: #0090FF; font-size: 12px;">Inicio</a></li>
									<li><a
										href="#{request.contextPath}/pages/proceso/toma_inventario.xhtml"
										style="color: #0090FF; font-size: 12px;">Proceso</a></li>
									<li class="active" style="font-size: 12px;">Ajuste de
										Inventario</li>
								</ol>
							</div>
						</section>
					</div>
					<!-- END BUTTONS -->


					<!-- BEGIN PANEL REGISTER -->
					<div class="row" style="padding-top: 10px;">

						<!-- TABLE -->
						<ui:fragment rendered="#{ tomaInventarioController.verLista}">
							<div class="col-md-12">
								<div class="panel panel-default">
									<div class="panel-heading">
										<h3 class="panel-title">Lista Ajustes de inventarios</h3>
									</div>
									<!-- start here datatable -->
									<div class="box-content no-padding">

										<p:dataTable
											style="font-size: 12px !important; line-height: 1.33846154 !important; font-family: sans-serif !important;"
											rowKey="#{_var.id}" id="tomaInventarioTable" var="_var"
											value="#{tomaInventarioController.listTomaInventario}"
											selectionMode="single"
											selection="#{tomaInventarioController.selectedTomaInventario}"
											emptyMessage="No se encontraron Registros.">

											<p:ajax event="rowSelect" update="form001"
												listener="#{tomaInventarioController.onRowSelectTomaInventarioClick}" />

											<p:column width="7%" headerText="Código"
												style="text-align:center;" filterBy="#{_var.id}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.id}" />
											</p:column>

											<p:column headerText="Almacén"
												filterBy="#{_var.almacen.nombre}" filterStyle="width: 100%;"
												filterMatchMode="contains">
												<h:outputText value="#{_var.almacen.nombre}" />
											</p:column>

											<p:column headerText="Nombre Responsable"
												filterBy="#{_var.nombreResponsable}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.nombreResponsable}" />
											</p:column>

											<p:column headerText="Nombre Inventariador" width="15%"
												style="text-align:center;"
												filterBy="#{_var.nombreInventariador}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.nombreInventariador}">
												</h:outputText>
											</p:column>

											<p:column headerText="Tipo" width="8%"
												style="text-align:center;" filterBy="#{_var.tipo}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.tipo}">
												</h:outputText>
											</p:column>

											<p:column headerText="Estado" width="8%"
												style="text-align:center;" filterBy="#{_var.estado}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<span class="label label-primary"><h:outputText
														rendered="#{_var.estado=='AC'}" value="Activo" /></span>
												<span class="label label-danger"><h:outputText
														rendered="#{_var.estado=='IN'}" value="Inactivo" /></span>
												<span class="label label-success"><h:outputText
														rendered="#{_var.estado=='RE'}" value="Revisado" /></span>
												<span class="label label-success"><h:outputText
														rendered="#{_var.estado=='PR'}" value="Procesado" /></span>
												<span class="label label-success"><h:outputText
														rendered="#{_var.estado=='CN'}" value="Conciliado" /></span>
												<span class="label label-success"><h:outputText
														rendered="#{_var.estado=='CE'}" value="Cerrado" /></span>
											</p:column>

											<p:column width="10%" headerText="Fecha"
												style="text-align:center;" filterBy="#{_var.fechaRegistro}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.fechaRegistro}">
													<f:convertDateTime pattern="dd/MM/yyyy" />
												</h:outputText>
											</p:column>

											<p:column width="8%" headerText="Registro"
												style="text-align:center;"
												filterBy="#{_var.usuarioRegistro}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.usuarioRegistro}" />
											</p:column>

											<f:facet name="footer">
												<h:outputText
													value="#{tomaInventarioController.listTomaInventario.size()} Registros en Total" />
											</f:facet>

										</p:dataTable>
									</div>
									<!-- end here datatable -->
									<div class="panel-body"></div>

								</div>
							</div>

						</ui:fragment>

						<!-- FILTER -->
						<ui:fragment
							rendered="#{tomaInventarioController.registrar or tomaInventarioController.modificar or tomaInventarioController.conciliar}">
							<div class="col-md-4">
								<div class="panel panel-default">
									<div class="panel-heading">
										<h3 class="panel-title">Datos Toma Inventario</h3>
									</div>
									<div class="panel-body">
										<!-- start here register -->
										<div class="row">
											<div class="col-md-12 box-content form-horizontal">
											<ui:fragment rendered="false">
												<div class="form-group ">
													<div class="col-md-5">Tipo</div>
													<div class="col-md-7">
														<h:selectOneMenu id="tipoID"
															style=" color: #555555; background-image: none; width:100%;"
															styleClass="input-sm form-control" required="true"
															requiredMessage="Tipo Requerido."
															disabled="#{tomaInventarioController.modificar or tomaInventarioController.conciliar}"
															value="#{tomaInventarioController.newTomaInventario.tipo}">

															<p:ajax event="change" update="form001" />
															<f:selectItems
																value="#{tomaInventarioController.listTipo}" />
														</h:selectOneMenu>
													</div>
												</div>
												</ui:fragment>

												<div class="form-group ">
													<div class="col-md-5">Almacén</div>
													<div class="col-md-7">
														<p:autoComplete id="almacenID" style="width: 93%"
															inputStyle="width: 93%; color: #555555; background-image: none;padding: 4px 10px;"
															value="#{tomaInventarioController.selectedAlmacen.nombre}"
															completeMethod="#{tomaInventarioController.completeAlmacen}"
															minQueryLength="3" dropdown="true" forceSelection="true"
															var="_var" itemLabel="#{_var}" itemValue="#{_var.nombre}"
															disabled="#{tomaInventarioController.modificar or tomaInventarioController.conciliar}"
															placeholder="[Escriba Almacen]" scrollHeight="300">

															<p:ajax event="itemSelect" update="form001"
																listener="#{tomaInventarioController.onRowSelectAlmacenClick}" />

															<p:column>
																<h:outputText value="#{_var.nombre}" />
															</p:column>

														</p:autoComplete>

													</div>
												</div>

												<div class="form-group ">
													<div class="col-md-5">Responsable Almacén</div>
													<div class="col-md-7">
														<p:inputText id="responsableAlmacenID"
															style=" color: #555555; background-image: none;padding: 0px 10px;"
															styleClass="input-sm form-control" size="40"
															value="#{tomaInventarioController.newTomaInventario.nombreResponsable}"
															readonly="true">
															<p:ajax event="change" />
														</p:inputText>
													</div>
												</div>

												<div class="form-group ">
													<div class="col-md-5">Inventariador</div>
													<div class="col-md-7">
														<p:inputText id="inventariadorID"
															style=" color: #555555; background-image: none;padding: 0px 10px;"
															styleClass="input-sm form-control" size="40"
															value="#{tomaInventarioController.newTomaInventario.nombreInventariador}"
															disabled="#{tomaInventarioController.conciliar}">
															<p:ajax event="change" />
														</p:inputText>
													</div>
												</div>

												<div class="form-group ">
													<div class="col-md-5">Fecha</div>
													<div class="col-md-7">
														<p:calendar pattern="dd/MM/yyyy" id="fechaComp"
															locale="es" styleClass="myWid100"
															value="#{tomaInventarioController.newTomaInventario.fecha}"
															onkeypress="return permiteKey(event, 'none')"
															style=" color: #555555; background-image: none;"
															disabled="#{tomaInventarioController.modificar or tomaInventarioController.conciliar}">
															<p:ajax event="dateSelect" />
														</p:calendar>
													</div>
												</div>

											</div>
										</div>
									</div>
								</div>
							</div>
						</ui:fragment>
						<!-- MOSTRAR LOS PRODUCTOS DE EL ALMACEN SELECCIONADO -->
						<ui:fragment
							rendered="#{tomaInventarioController.registrar  and tomaInventarioController.newTomaInventario.tipo.equals('PARCIAL')}">

							<div class="col-md-8" align="left">

								<div class="panel panel-default">
									<div class="panel-heading">
										<h3 class="panel-title">Lista Producto 2</h3>
									</div>
									<!-- start here datatable -->
									<div class="box-content no-padding">

										<p:dataTable
											style="font-size: 12px !important; line-height: 1.33846154 !important; font-family: sans-serif !important;"
											rowKey="#{_var.id}" id="productoTable" var="_var"
											value="#{tomaInventarioController.listDetalleTomaInventario}"
											emptyMessage="No se encontraron Registros.">

											<p:column width="7%" headerText="Codigo"
												style="text-align:center;"
												filterBy="#{_var.producto.codigo}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.codigo}">
												</h:outputText>
											</p:column>

											<p:column width="15%" headerText="Nombre Item"
												filterBy="#{_var.producto.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.nombre}" />
											</p:column>

											<p:column width="7%" headerText="Unidad "
												style="text-align:center;"
												filterBy="#{_var.producto.unidadMedidas.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.unidadMedidas.nombre}" />
											</p:column>

											<p:column width="8%" headerText="Cantidad registrada"
												filterBy="#{_var.cantidadRegistrada}"
												style="text-align:center;" filterStyle="width: 100%;"
												filterMatchMode="contains">
												<h:outputText value="#{_var.cantidadRegistrada}">
												</h:outputText>
											</p:column>

											<p:column width="8%" headerText="Cantidad verificada"
												filterBy="#{_var.cantidadVerificada}"
												style="text-align:center;" filterStyle="width: 100%;"
												filterMatchMode="contains">
												<h:outputText
													value="#{_var.cantidadVerificada == null? ' ' :_var.cantidadVerificada}" />
											</p:column>

											<p:column headerText="Diferencia" width="8%"
												style="text-align:center;" filterBy="#{_var.diferencia}"
												filterStyle="width: 100%; " filterMatchMode="contains">
												<h:outputText
													value="#{_var.diferencia == null? ' ' :_var.diferencia}" />
											</p:column>

											<p:column headerText="Observación" width="8%"
												filterBy="#{_var.observacion}" filterStyle="width: 100%; "
												filterMatchMode="contains">
												<h:outputText value="#{_var.observacion}" />
											</p:column>

										</p:dataTable>
									</div>
									<!-- end here datatable -->
									<div class="panel-body"></div>

								</div>
							</div>
						</ui:fragment>
						<!-- MOSTRAR CIERRE DE ALMACEN -->
						<ui:fragment
							rendered="#{tomaInventarioController.cierreAlmacen || tomaInventarioController.newTomaInventario.tipo.equals('FINAL')}">

							<div class="col-md-8" align="left">

								<div class="panel panel-default">
									<div class="panel-heading">
										<h3 class="panel-title">Lista Producto - Cierre Almacén</h3>
									</div>
									<!-- start here datatable -->
									<div class="box-content no-padding">

										<p:dataTable
											style="font-size: 12px !important; line-height: 1.33846154 !important; font-family: sans-serif !important;"
											rowKey="#{_var.id}" id="productoTableCierre" var="_var"
											value="#{tomaInventarioController.listDetalleTomaInventario}"
											emptyMessage="No se encontraron Registros.">

											<p:column width="7%" headerText="Codigo"
												style="text-align:center;"
												filterBy="#{_var.producto.codigo}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.codigo}">
												</h:outputText>
											</p:column>

											<p:column width="15%" headerText="Nombre Item"
												filterBy="#{_var.producto.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.nombre}" />
											</p:column>

											<p:column width="7%" headerText="Unidad "
												style="text-align:center;"
												filterBy="#{_var.producto.unidadMedidas.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.unidadMedidas.nombre}" />
											</p:column>

											<p:column width="8%" headerText="Cantidad registrada"
												filterBy="#{_var.cantidadRegistrada}"
												style="text-align:center;" filterStyle="width: 100%;"
												filterMatchMode="contains">
												<h:outputText value="#{_var.cantidadRegistrada}">
												</h:outputText>
											</p:column>

										</p:dataTable>
									</div>
									<!-- end here datatable -->
									<div class="panel-body"></div>

								</div>
							</div>
						</ui:fragment>
						<!-- TABLA DETALLE TOMAINVENTARIO A CONCILIAR  -->
						<ui:fragment rendered="#{tomaInventarioController.conciliar}">

							<div class="col-md-8" align="left">

								<div class="panel panel-default">
									<div class="panel-heading">
										<h3 class="panel-title">Seleccione los Items a conciliar</h3>
									</div>
									<!-- start here datatable -->
									<div class="box-content no-padding">

										<p:dataTable
											style="font-size: 12px !important; line-height: 1.33846154 !important; font-family: sans-serif !important; margin-bottom:0;"
											rowKey="#{_var.id}" id="productoTableConciliar" var="_var"
											editable="true"
											value="#{tomaInventarioController.listDetalleTomaInventario}"
											selection="#{tomaInventarioController.listSelectedDetalleTomaInventario}"
											emptyMessage="No se encontraron Registros." editMode="cell">

											<p:column selectionMode="multiple"
												style="width:16px;text-align:center" />
											<p:ajax event="rowSelectCheckbox" update="@form" />
											<p:ajax event="rowUnselectCheckbox" update="@form" />

											<p:column width="7%" headerText="Código"
												style="text-align:center;" filterBy="#{_var.producto.id}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.id}">
												</h:outputText>
											</p:column>

											<p:column width="15%" headerText="Nombre Item"
												filterBy="#{_var.producto.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.nombre}" />
											</p:column>

											<p:column width="8%" headerText="Unidad "
												style="text-align:center;"
												filterBy="#{_var.producto.unidadMedidas.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.unidadMedidas.nombre}" />
											</p:column>

											<p:column width="8%" headerText="Cantidad registrada"
												filterBy="#{_var.cantidadRegistrada}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.cantidadRegistrada}">
												</h:outputText>
											</p:column>

											<p:column width="8%" headerText="Cantidad verificada"
												filterBy="#{_var.cantidadVerificada}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText
													value="#{_var.cantidadVerificada == null? ' ' :_var.cantidadVerificada}" />
											</p:column>

											<p:column headerText="Diferencia" width="8%"
												filterBy="#{_var.diferencia}" filterStyle="width: 100%; "
												filterMatchMode="contains">
												<h:outputText
													value="#{_var.diferencia == null? ' ' :_var.diferencia}" />
											</p:column>

											<p:column width="15%" headerText="Observación"
												filterBy="#{_var.observacion}" style="text-align:center;"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<p:cellEditor>
													<f:facet name="output">
														<h:outputText value="#{_var.observacion}" />
													</f:facet>
													<f:facet name="input">
														<p:inputText id="modelInput1" value="#{_var.observacion}"
															style="width:96%" />
													</f:facet>
												</p:cellEditor>
											</p:column>

										</p:dataTable>
									</div>
									<!-- end here datatable -->
									<div class="panel-body"></div>

								</div>
							</div>
						</ui:fragment>
						<!-- TABLA DETALLETOMAINVENTARIO PARA EDITAR CAMPOS DE VERIFICACION, DIFERENCIA Y OBSERVACION -->
						<ui:fragment
							rendered="#{tomaInventarioController.modificar and !tomaInventarioController.buttonEditarTomaInventarioIncial}">
							<div class="col-md-8" align="left">

								<div class="panel panel-default">
									<div class="panel-heading">
										<h3 class="panel-title">Lista Producto </h3>
									</div>
									<!-- start here datatable -->
									<div class="box-content no-padding">

										<p:dataTable
											style="font-size: 12px !important; line-height: 1.33846154 !important; font-family: sans-serif !important;"
											rowKey="#{_var.id}" id="productoTable2" var="_var"
											value="#{tomaInventarioController.listDetalleTomaInventario}"
											editable="true" editMode="cell"
											emptyMessage="No se encontraron Registros.">

											<p:column width="5%" headerText="Código"
												style="text-align:center;" filterBy="#{_var.producto.id}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.id}">
												</h:outputText>
											</p:column>

											<p:column width="15%" headerText="Nombre Item"
												filterBy="#{_var.producto.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.nombre}" />
											</p:column>

											<p:column width="8%" headerText="Unidad "
												style="text-align:center;"
												filterBy="#{_var.producto.unidadMedidas.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.unidadMedidas.nombre}" />
											</p:column>

											<p:column width="8%" headerText="Cantidad registrada"
												filterBy="#{_var.cantidadRegistrada}"
												style="text-align:center;" filterStyle="width: 100%;"
												filterMatchMode="contains">
												<h:outputText value="#{_var.cantidadRegistrada}">
												</h:outputText>
											</p:column>

											<p:column width="8%" headerText="Cantidad verificada"
												filterBy="#{_var.cantidadVerificada}"
												style="text-align:center;" filterStyle="width: 100%;"
												filterMatchMode="contains">
												<p:cellEditor>
													<f:facet name="output">
														<h:outputText
															value="#{_var.cantidadVerificada == null? ' ' :_var.cantidadVerificada}" />
													</f:facet>
													<f:facet name="input">
														<p:inputText id="modelInput1"
															value="#{_var.cantidadVerificada}" style="width:96%" />
													</f:facet>
												</p:cellEditor>
											</p:column>

											<p:column headerText="Diferencia" width="8%"
												style="text-align:center;" filterBy="#{_var.diferencia}"
												filterStyle="width: 100%; " filterMatchMode="contains">
												<p:cellEditor>
													<f:facet name="output">
														<h:outputText
															value="#{_var.diferencia == null? ' ' :_var.diferencia}" />
													</f:facet>
													<f:facet name="input">
														<p:inputText id="modelInput2" value="#{_var.diferencia}"
															style="width:96%" />
													</f:facet>
												</p:cellEditor>
											</p:column>

											<p:column headerText="Observación" width="10%"
												filterBy="#{_var.observacion}" filterStyle="width: 100%; "
												filterMatchMode="contains">
												<p:cellEditor>
													<f:facet name="output">
														<h:outputText value="#{_var.observacion}" />
													</f:facet>
													<f:facet name="input">
														<p:inputText id="modelInput3" value="#{_var.observacion}"
															style="width:96%" />
													</f:facet>
												</p:cellEditor>
											</p:column>

										</p:dataTable>
									</div>
									<!-- end here datatable -->
									<div class="panel-body"></div>

								</div>
							</div>
						</ui:fragment>
						<ui:fragment
							rendered="#{(tomaInventarioController.registrar or tomaInventarioController.modificar) and tomaInventarioController.newTomaInventario.tipo.equals('INICIAL') or editarTomaInventarioIncial}">
							<div class="col-md-8" align="left">

								<div class="panel panel-default">
									<div class="panel-heading">
										<h3 class="panel-title">Lista Producto 1</h3>
										<div class="actions mtn">
											<div class="btn-group btn-group-xs">
												<p:commandLink id="buttonDlgTelefono"
													value="&#160; PRODUCTO"
													styleClass="btn btn-success btn-outlined ion-plus-round"
													style="height:27px; padding-top: 5px" immediate="true"
													action="#{tomaInventarioController.loadDialogProducto()}">
												</p:commandLink>
												<p:tooltip for="buttonDlgTelefono" value=".">

													<div class="panel">
														<div class="panel-heading">
															<h3 class="panel-title">
																<strong class="text-uppercase text-orange">Información</strong>
															</h3>
														</div>
														<div class="panel-body">
															<p class="mbl">Agregue producto , en el almacen
																correspondiente.</p>
														</div>
													</div>
												</p:tooltip>
											</div>
										</div>
									</div>
									<!-- start here datatable -->
									<div class="box-content no-padding">

										<p:dataTable id="itemsTable1"
											style="font-size: 12px !important; line-height: 1.33846154 !important; font-family: sans-serif !important;"
											rowKey="#{_var.producto}" var="_var"
											value="#{tomaInventarioController.listaDetalleOrdenIngreso}"
											emptyMessage="No se encontraron Registros de ITEMS."
											rows="20" paginator="true"
											paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
											rowsPerPageTemplate="5,20,30">
											
											<p:column width="5%" headerText="Código"
												filterBy="#{_var.producto.codigo}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.codigo}" />
											</p:column>

											<p:column width="10%" headerText="Nombre"
												filterBy="#{_var.producto.nombre}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.nombre}" />
											</p:column>
											
											<p:column width="10%" headerText="Descripción"
												filterBy="#{_var.producto.descripcion}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.producto.descripcion}" />
											</p:column>

											<p:column headerText="Cantidad" width="5%"
												filterBy="#{_var.cantidad}" style="text-align:center;"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.cantidad}" />
											</p:column>

											<p:column headerText="Precio Compra" width="6%"
												filterBy="#{_var.precioCompra}"
												style="text-align:center;" filterStyle="width: 100%;"
												filterMatchMode="contains">
												<h:outputText value="#{_var.precioCompra}">
													<f:convertNumber pattern="#,##0.00" />
												</h:outputText>
											</p:column>

											<p:column headerText="Total" width="6%"
												filterBy="#{_var.total}" style="text-align:center;"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.totalCompra}">
													<f:convertNumber pattern="#,##0.00" />
												</h:outputText>
											</p:column>

											<p:column width="12%" headerText="Obervación"
												style="text-align:center;" filterBy="#{_var.observacion}"
												filterStyle="width: 100%;" filterMatchMode="contains">
												<h:outputText value="#{_var.observacion}" />
											</p:column>

											<p:column width="7%" headerText="Acción"
												style="text-align:center;">
												<div class="row">
													<div class="btn-group-demo">
														<div class="btn-group">
															<p:commandLink id="buttonModificarDetalle" value="&#160;"
																styleClass="btn ion-edit"
																style="padding-left: 5px; padding-right: 5px;"
																immediate="true"
																actionListener="#{tomaInventarioController.editarDetalleOrdenIngreso(_var.id)}" />
															<p:commandLink id="buttonEliminarDetalle"
																style="padding-left: 5px; padding-right: 5px;"
																value="&#160;" styleClass="btn ion-trash-b"
																immediate="true"
																actionListener="#{tomaInventarioController.borrarDetalleOrdenIngreso(_var.id)}" />
														</div>
													</div>
												</div>
											</p:column>

										</p:dataTable>
									</div>
								</div>
							</div>
						</ui:fragment>

						<!-- REPORTE -->
						<ui:fragment rendered="#{tomaInventarioController.verReport}">
							<div class="col-md-12">
								<div class="panel panel-default">
									<div class="panel-body" style="text-align: center;">
										<p:media player="pdf" rendered="true"
											value="#{tomaInventarioController.urlTomaInventario}"
											width="800px" height="1125px" />
									</div>
								</div>
							</div>
						</ui:fragment>
					</div>
					<!-- END PANEL TABLE -->
				</h:form>
			</section>
		</div>
		<!--END CONTENT-->

		<!-- START GROWL formGrowl:msgs1 -->
		<h:form id="formGrowl">
			<p:growl id="msgs1" showDetail="true" />
		</h:form>
		<!-- END GROWL -->


		<!-- dlgValidacionProyFunc -->
		<p:dialog header="Validación" widgetVar="dlgValidacionProyFunc"
			modal="true" visible="#{not empty facesContext.maximumSeverity}"
			resizable="false" position="center" width="500px">
			<h:form id="formValidacionProyFunc">
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<div class="col-md-12">Desea agregar todos los Proveedores
								a la Nueva Gestión?</div>
							<div class="col-md-12">
								<label class="switch switch-success switch-sm"> <h:selectBooleanCheckbox
										value="#{tomaInventarioController.stateProveedor}"
										styleClass="switch">
									</h:selectBooleanCheckbox> <span class="switch"></span>

								</label>
							</div>
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<div class="col-md-4"></div>
							<div class="col-md-4">
								<p:commandLink id="buttonCancelardlgValidacionProyFunc"
									value="&#160; Cancelar"
									styleClass="btn btn-warning ion-minus-circled btn-block"
									onclick="PF('dlgValidacionProyFunc').hide();" immediate="true">
								</p:commandLink>
							</div>
							<div class="col-md-4">
								<p:commandLink id="buttonRegistardlgValidacionProyFunc"
									value="&#160; Registrar"
									styleClass="btn btn-success ion-checkmark btn-block"
									onclick="PF('dlgValidacionProyFunc').hide();">
									<p:ajax update="form001"
										listener="#{tomaInventarioController.registrarTomaInventario()}" />
								</p:commandLink>
							</div>
						</div>
					</div>
				</div>
			</h:form>
		</p:dialog>

		<!-- DIALOG PRODUCTO -->
		<p:dialog widgetVar="dlgProducto" resizable="false"
			header="#{tomaInventarioController.tituloProducto}" showHeader="true"
			modal="false" closeOnEscape="true" draggable="true" position="center"
			style="padding: 0px 0px 0px 0px;" width="600"
			visible="#{partidaController.diagloProducto}" id="modalProductoID">
			<h:form id="formDialogProducto">
				<ui:fragment rendered="#{ ! tomaInventarioController.nuevoProducto}">
					<!-- ocultar si se va a creaer producto -->
					<div class="row">
						<div class="form-group ">
							<div class="col-md-3">Proveedor</div>
							<div class="col-md-9">
								<p:autoComplete id="proveedorID" style="width: 100%"
									inputStyle="width: 93%; color: #555555; background-image: none;padding: 4px 10px;"
									value="#{tomaInventarioController.selectedProveedor.nombre}"
									completeMethod="#{tomaInventarioController.completeProveedor}"
									minQueryLength="1" dropdown="true" required="true"
									requiredMessage="Proveedor Requerido." forceSelection="true"
									var="_var" itemLabel="#{_var}" itemValue="#{_var.nombre}"
									disabled="#{tomaInventarioController.conciliar}"
									placeholder="[Escriba Proveedor]" scrollHeight="300">
									<p:ajax event="itemSelect"
										listener="#{tomaInventarioController.onRowSelectProveedorClick}" />
									<p:column>
										<h:outputText value="#{_var.codigo}" />
									</p:column>
									<p:column>
										<h:outputText value="#{_var.nombre}" />
									</p:column>
									<p:column>
										<h:outputText value="#{_var.direccion}" />
									</p:column>
								</p:autoComplete>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<div class="col-md-3">Producto</div>
							<div class="col-md-8">
								<p:autoComplete id="productoID" style="width: 100%"
									inputStyle="width: 93%; color: #555555; background-image: none;padding: 4px 10px;"
									value="#{tomaInventarioController.selectedProducto}" converter="productoConverter"
									completeMethod="#{tomaInventarioController.completeProducto}"
									minQueryLength="1" size="30" dropdown="true" required="true"
									requiredMessage="Producto Requerido." forceSelection="true"
									var="_var" itemLabel="#{_var.nombre}" itemValue="#{_var}"
									placeholder="[Escriba Producto]" scrollHeight="300">
									<p:ajax event="itemSelect" update="productoID"
										listener="#{tomaInventarioController.onRowSelectProductoClick}" />
									<p:column>
										<h:outputText value="#{_var.codigo}" />
									</p:column>
									<p:column>
										<h:outputText value="#{_var.nombre}" />
									</p:column>
									<p:column>
										<h:outputText value="#{_var.descripcion}" />
									</p:column>

								</p:autoComplete>
							</div>
							<div class="col-md-1" style="padding-right: 5px;">
								<p:commandLink value="&#160; "
									styleClass="btn btn-default ion-plus"
									style="height:31px;  width: 29px; padding: 4px 6px; "
									immediate="true">
									<p:ajax update="formDialogProducto"
										listener="#{tomaInventarioController.setNuevoProducto(true)}" />
								</p:commandLink>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label class="col-sm-3 control-label">Garantía</label>
							<div class="col-sm-9">
								<p:inputText id="garantiaID" required="true"
									requiredMessage="Garantía Requerido."
									style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.garantia}"
									size="40">
									<p:ajax event="change" />
								</p:inputText>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label for="descripcionID" class="col-sm-3 control-label">Observación</label>
							<div class="col-sm-9">
								<p:inputTextarea id="descripcionID" required="true"
									requiredMessage="Observacion Requerido."
									style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.observacion}"
									size="20" rows="2" cols="39">
									<p:ajax event="change" />
								</p:inputTextarea>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label class="col-sm-3 control-label">Precio Compra</label>
							<div class="col-sm-9">
								<p:inputText id="precioCompraID" required="true"
									requiredMessage="Precio Requerido." style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.precioCompra}"
									size="40">
									<p:ajax event="change" update="precioVCoID,precioVCrID,totalID"
										listener="#{tomaInventarioController.calcularPorcentajePrecio()}" />
									<f:convertNumber pattern="#,##0.00" locale="en" />
								</p:inputText>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label class="col-sm-3 control-label">Precio Venta
								Contado</label>
							<div class="col-sm-9">
								<p:inputText id="precioVCoID" required="true"
									requiredMessage="Precio Requerido." style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.precioVentaContado}"
									size="40">
									<p:ajax event="change" update="totalID"
										listener="#{tomaInventarioController.calcular()}" />
									<f:convertNumber pattern="#,##0.00" locale="en" />
								</p:inputText>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label class="col-sm-3 control-label">Precio Venta
								Credito</label>
							<div class="col-sm-9">
								<p:inputText id="precioVCrID" required="true"
									requiredMessage="Precio Requerido." style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.precioVentaCredito}"
									size="40">
									<p:ajax event="change" />
									<f:convertNumber pattern="#,##0.00" locale="en" />
								</p:inputText>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label class="col-sm-3 control-label">Stock Inicial</label>
							<div class="col-sm-9">
								<p:inputText id="cantidadID" required="true"
									requiredMessage="Cantidad Requerido."
									style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.cantidad}"
									size="40">
									<p:ajax event="change" update="totalID"
										listener="#{tomaInventarioController.calcular()}" />
								</p:inputText>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label class="col-sm-3 control-label">Stock Mínimo</label>
							<div class="col-sm-9">
								<p:inputText id="cantidadMinimaID" required="true"
									requiredMessage="Cantidad Requerido."
									style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.cantidadMinima}"
									size="40">
									<p:ajax event="change" />
								</p:inputText>
							</div>
						</div>
					</div>
					<br />
					<div class="row">
						<div class="form-group">
							<label for="totalID" class="col-sm-3 control-label">Total Compra</label>
							<div class="col-sm-9">
								<p:inputText id="totalID" required="true"
									requiredMessage="Total Requerido." readonly="true"
									style="padding: 4px 10px;"
									value="#{tomaInventarioController.selectedDetalleOrdenIngreso.totalCompra}"
									size="40">
									<f:convertNumber pattern="#,##0.000" locale="en" />
								</p:inputText>
							</div>
						</div>
					</div>

					<br />
					<div class="row">
						<div class="col-sm-12">
							<div class="form-group">
								<div class="col-md-4"></div>
								<div class="col-md-4">
									<p:commandLink value="&#160; Cerrar"
										styleClass="btn btn-warning ion-minus-circled btn-block"
										immediate="true"
										action="#{tomaInventarioController.actionCerrarDialogProducto()}">
									</p:commandLink>
								</div>
								<div class="col-md-4">
									<p:commandLink value="&#160; Agregar"
										styleClass="btn btn-success ion-checkmark btn-block"
										immediate="true"
										rendered="#{ ! tomaInventarioController.editarOrdenIngreso}"
										action="#{tomaInventarioController.actionAgregarProducto()}">
									</p:commandLink>

									<p:commandLink value="&#160; Modificar"
										styleClass="btn btn-success ion-checkmark btn-block"
										onclick="PF('dlgProducto').hide();"
										rendered="#{tomaInventarioController.editarOrdenIngreso}">
										<p:ajax update="form001"
											listener="#{tomaInventarioController.modificarDetalleOrdenIngreso()}" />
									</p:commandLink>
								</div>
							</div>
						</div>
					</div>

				</ui:fragment>
				<ui:fragment rendered="#{tomaInventarioController.nuevoProducto}">
					<!-- mostrar si se va a crear producto -->
					<div class="row">
						<div class="col-md-12 box-content form-horizontal">

							<div class="form-group ">
								<div class="col-md-4">Codigo</div>
								<div class="col-md-8">
									<p:inputText id="nuevoCodigoID"
										style=" color: #555555; background-image: none;padding: 4px 10px;"
										styleClass="input-sm form-control" size="40"
										value="#{tomaInventarioController.newProducto.codigo}"
										required="true" requiredMessage="Requerido.">
										<p:ajax event="change" />
									</p:inputText>
								</div>
							</div>

							<div class="form-group ">
								<div class="col-md-4">Nombre Producto</div>
								<div class="col-md-8">
									<p:inputText id="nuevoNombreID"
										style=" color: #555555; background-image: none;padding: 4px 10px;"
										styleClass="input-sm form-control" size="40"
										value="#{tomaInventarioController.newProducto.nombre}"
										required="true" requiredMessage="Requerido.">
										<p:ajax event="change" />
									</p:inputText>
								</div>
							</div>
							<div class="form-group ">
								<div class="col-md-4">Descripción</div>
								<div class="col-md-8">
									<p:inputText id="nuevoDescripcionID"
										style=" color: #555555; background-image: none;padding: 4px 10px;"
										styleClass="input-sm form-control" size="40"
										value="#{tomaInventarioController.newProducto.descripcion}"
										required="true" requiredMessage="Requerido.">
										<p:ajax event="change" />
									</p:inputText>
								</div>
							</div>

							<div class="form-group ">
								<div class="col-md-4">Unidad medida</div>
								<div class="col-md-8">
									<h:selectOneMenu id="unidadMedidaID"
										value="#{tomaInventarioController.newProducto.unidadMedidas.id}"
										styleClass="form-control" required="true"
										requiredMessage="Unidad Medida Requerido.">
										<f:selectItem itemValue="SELECCIONE" itemLabel="SELECCIONE" />
										<f:selectItems value="#{productoController.listUnidadMedida}"
											var="_pro" itemLabel="#{_pro.nombre}" itemValue="#{_pro.id}" />
										<p:ajax event="change" />
									</h:selectOneMenu>
								</div>
							</div>

							<div class="form-group ">
								<div class="col-md-4">Grupo Producto</div>
								<div class="col-md-8">
									<h:selectOneMenu id="grupoID"
										value="#{tomaInventarioController.newProducto.grupoProducto.id}"
										styleClass="form-control" required="true"
										requiredMessage="Encargado Requerido.">
										<f:selectItem itemValue="SELECCIONE" itemLabel="SELECCIONE" />
										<f:selectItems value="#{productoController.listGrupoProducto}"
											var="_pro" itemLabel="#{_pro.nombre}" itemValue="#{_pro.id}" />
										<p:ajax event="change" />
									</h:selectOneMenu>
								</div>
							</div>

							<div class="form-group ">
								<div class="col-md-4">Línea Producto</div>
								<div class="col-md-8">
									<h:selectOneMenu id="lineaID"
										value="#{tomaInventarioController.newProducto.lineaProducto.id}"
										styleClass="form-control" required="true"
										requiredMessage="Linea Requerido.">
										<f:selectItem itemValue="SELECCIONE" itemLabel="SELECCIONE" />
										<f:selectItems value="#{productoController.listLineaProducto}"
											var="_pro" itemLabel="#{_pro.nombre}" itemValue="#{_pro.id}" />
										<p:ajax event="change" update="lineaID" />
									</h:selectOneMenu>
								</div>
							</div>

						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<div class="form-group">
								<div class="col-md-4"></div>
								<div class="col-md-4">
									<p:commandLink value="&#160; Cancelar"
										styleClass="btn btn-warning ion-minus-circled btn-block"
										immediate="true">
										<p:ajax update="formDialogProducto"
											listener="#{tomaInventarioController.setNuevoProducto(false)}" />
									</p:commandLink>
								</div>
								<div class="col-md-4">
									<p:commandLink value="&#160; Registrar"
										styleClass="btn btn-success ion-checkmark btn-block">
										<p:ajax update="formDialogProducto"
											listener="#{tomaInventarioController.registrarProducto()}" />
									</p:commandLink>
								</div>
							</div>
						</div>
					</div>
				</ui:fragment>
			</h:form>
		</p:dialog>


	</ui:define>

	<ui:insert name="scripts">

	</ui:insert>
</ui:composition>